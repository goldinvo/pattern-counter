(this["webpackJsonppattern-counter"]=this["webpackJsonppattern-counter"]||[]).push([[0],[,,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var i=n(2),s=n.n(i),a=n(9),r=n.n(a),o=(n(14),n(3)),c=n(4),u=n(5),d=n(1),h=n(7),l=n(6),p=(n(15),n(0));var b=function(t){return Object(p.jsxs)("form",{onSubmit:t.onSubmit,className:"PatternForm",children:[Object(p.jsx)("label",{children:"Input Pattern Below: "}),Object(p.jsx)("textarea",{value:t.value,onChange:t.onChange}),Object(p.jsx)("input",{type:"submit",value:"Submit"})]})},f=Object.freeze({INSTR_CNT:"instrcnt",INFO:"info",NUM:"num",STR:"str",OPN_PAREN:"opnparen",CLS_PAREN:"clsparen",REP:"rep",SEP:"sep"});function v(t){return t.match(/^\d+\.$/)?f.INSTR_CNT:t.match(/(\(.*?\))/)?f.INFO:"("===t||"{"===t||"["===t?f.OPN_PAREN:")"===t||"}"===t||"]"===t?f.CLS_PAREN:"*"===t?f.REP:","===t||"."===t?f.SEP:t.match(/^\d+$/)?f.NUM:f.STR}var j=function(t,e){return{type:t,value:e}};var x=function(t){var e=[],n=0;t.instruction.forEach((function(i,s){i.type===f.OPN_PAREN?s<t.tokIndex?e.push(s):n++:i.type===f.CLS_PAREN&&(s<t.tokIndex?e.pop():n?n--:e.push(s))}));var i=0,s=[],a=t.instruction.map((function(n,a){var r=a===t.tokIndex?"focusedText ":"";return e.includes(a)&&(n.type===f.OPN_PAREN?(r+=t.colors[i],s.push(t.colors[i]),i+1<t.colors.length&&i++):r+=s.pop()),Object(p.jsx)("span",{className:r,children:n.value+" "},a)}));return Object(p.jsx)("div",{className:"instructionText",children:a})};n(17);var m=function(t){return Object(p.jsxs)("div",{className:"counter "+t.color,children:[Object(p.jsxs)("form",{children:[Object(p.jsx)("label",{htmlFor:"counterInput",children:t.name}),Object(p.jsx)("input",{type:"text",maxLength:"3",autoComplete:"off",id:"counterInput",value:t.value,onChange:t.onChange})]}),t.controls?t.controls:null]})},O=function(t){Object(h.a)(n,t);var e=Object(l.a)(n);function n(){var t;return Object(c.a)(this,n),(t=e.call(this)).state={count:"0"},t.handleChange=t.handleChange.bind(Object(d.a)(t)),t.increment=t.increment.bind(Object(d.a)(t)),t.reset=t.reset.bind(Object(d.a)(t)),t.onKeyPressed=t.onKeyPressed.bind(Object(d.a)(t)),t}return Object(u.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyPressed)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyPressed)}},{key:"onKeyPressed",value:function(t){if("TEXTAREA"!==t.target.tagName)switch(t.key){case"z":t.ctrlKey||this.increment(1);break;case"x":this.increment(10);break;default:return}}},{key:"handleChange",value:function(t){var e=t.target.value;e.match(/\D/)||(e=parseInt(e),this.setState({count:e||""}))}},{key:"increment",value:function(t){var e=Number(this.state.count)+t;this.setState({count:e<=999?""+e:""+(e-999-1)})}},{key:"reset",value:function(){this.setState({count:"0"})}},{key:"render",value:function(){var t=this,e=Object(p.jsxs)("div",{id:"controls",style:{display:"flex",justifyContent:"center"},children:[Object(p.jsx)("button",{type:"button",onClick:function(){return t.increment(1)},children:"+1 (z)"}),Object(p.jsx)("button",{type:"button",onClick:function(){return t.increment(10)},children:"+10 (x)"}),Object(p.jsx)("button",{type:"button",onClick:this.reset,children:"Reset"})]});return Object(p.jsx)("div",{className:"manual-counter",children:Object(p.jsx)(m,{name:"Manual Counter",onChange:this.handleChange,value:this.state.count,controls:e})})}}]),n}(i.Component),y=(n(18),["red","orange","yellow"]),N=[{type:f.STR,value:"Pattern Finished!"}];var S=function(t){if(t.finished)return Object(p.jsx)(x,{instruction:N,tokIndex:0,colors:y});var e=t.repeats.map((function(e,n){var i=n<y.length?y[n]:y[y.length-1];return Object(p.jsx)(m,{color:i,name:"Repeat Counter ".concat(n+1),value:e.numRepeats,onChange:function(e){t.onRepeatChange(n,e)}},n)}));return Object(p.jsxs)("div",{className:"instructionView",children:[Object(p.jsx)(x,{instruction:t.instruction,tokIndex:t.tokIndex,colors:y}),Object(p.jsxs)("div",{className:"countersContainer",children:[e,Object(p.jsx)(O,{})]})]})},k=function(){var t=Object.freeze({NO_INPUT:"Please input a pattern",PAREN_MATCH:"One of the instructions has a mismatched count of open and closed parenthesis"});return{tokenize:function(t){var e=t.trim().split("\n").filter((function(t){return""!==t.trim()})).map((function(t){return t.trim().split(/([(){}[\].,*])/).map((function(t){return t.trim()})).filter((function(t){return""!==t}))}));return e=e.map((function(t){return function(t){var e=[],n=0;v(t[0]+t[1])===f.INSTR_CNT&&(e.push(j(f.INSTR_CNT,t[0]+t[1])),n+=2);for(;n<t.length;){var i=v(t[n]);if(i===f.OPN_PAREN){var s=t[n]+t[n+1],a=t[n]+t[n+1]+t[n+2];if(v(s)===f.INFO){e.push(j(f.INFO,s)),n+=2;continue}if(v(a)===f.INFO){e.push(j(f.INFO,a)),n+=3;continue}}e.push(j(i,t[n])),n++}return e}(t)}))},isInvalid:function(e){if(!e[0]||!e[0][0])return t.NO_INPUT;var n=!0;return e.forEach((function(t){0!==t.reduce((function(t,e){return e.type===f.OPN_PAREN?t++:e.type===f.CLS_PAREN&&t--,t}),0)&&(n=!1)})),!n&&t.PAREN_MATCH},PTN_ERR:t}}();n(19);function I(t){var e,n,i,s=t.pattern,a=t.instrIndex,r=t.tokIndex,o=t.finished,c=t.repeats.slice();s[a][r].type===f.OPN_PAREN?(c.push({index:r,numRepeats:0}),r++):s[a][r].type===f.CLS_PAREN?(e=s[a],n=r,i=c[c.length-1].numRepeats,e[n].type!==f.CLS_PAREN&&console.log("fxn needToRepeat!!!!!"),e[n+1]&&e[n+1].type!==f.REP||!e[n+2]||e[n+2].type!==f.NUM||i<Number(e[n+2].value)-1?(r=c[c.length-1].index+1,c[c.length-1].numRepeats++):(c.pop(),r++)):r++,s[a][r]||(a>=s.length-1?(r=t.tokIndex,c=t.repeats.slice(),o=!0):(a++,r=0)),t.pattern=s,t.instrIndex=a,t.tokIndex=r,t.repeats=c,t.finished=o}function g(t){var e=t.instrIndex,n=t.tokIndex,i=JSON.parse(JSON.stringify(t.repeats));do{I(t)}while(t.pattern[t.instrIndex][t.tokIndex].type!==f.STR&&!t.finished);t.finished&&(t.instrIndex=e,t.tokIndex=n,t.repeats=i)}var R=function(t){Object(h.a)(n,t);var e=Object(l.a)(n);function n(){var t;Object(c.a)(this,n),t=e.call(this);var i=JSON.parse(localStorage.getItem("patternCounterState"));return t.state=i||{patternInput:"Press the 'Next' button or spacebar to advance!\n\n4. sc 3, hdc, dc 3, hdc, sc 3\n5. (sc 3, dc 5) * 3 (24 sts) (parenthesis without commas or periods are ignored)\n\nOn the next instruction try using the 'Complete Repeat' button! \n\n6. ((sc 2, dec, sc 2, dec) * 5, sc) * 3\n\nYou can also type into the counter display to edit counts directly!\n\n7. ((sc, dc, sc) * 594, sc 3, dc 2) * 2 (Click on the orange counter number and type in something else)\n\nSwitch to a G hook (Instructions don't have to start with a number)\n\nYou will need to use the 'Exit repeat' button in the next instruction\n\n8. (sc 3, picot) until end of row, sc, hdc, dc\n\nCut and weave in ends (Now try your own pattern!)\n",pattern:void 0,instrIndex:0,tokIndex:0,finished:!1,repeats:[],previousStates:[]},t.initialize=t.initialize.bind(Object(d.a)(t)),t.handleFormChange=t.handleFormChange.bind(Object(d.a)(t)),t.handleFormSubmit=t.handleFormSubmit.bind(Object(d.a)(t)),t.next=t.next.bind(Object(d.a)(t)),t.nextInstruction=t.nextInstruction.bind(Object(d.a)(t)),t.finishRepeat=t.finishRepeat.bind(Object(d.a)(t)),t.addRepeat=t.addRepeat.bind(Object(d.a)(t)),t.handleRepeatChange=t.handleRepeatChange.bind(Object(d.a)(t)),t.onKeyPressed=t.onKeyPressed.bind(Object(d.a)(t)),t.undo=t.undo.bind(Object(d.a)(t)),t.saveAndDo=t.saveAndDo.bind(Object(d.a)(t)),t}return Object(u.a)(n,[{key:"initialize",value:function(t){this.setState({patternInput:t,pattern:void 0,instrIndex:0,tokIndex:0,finished:!1,repeats:[],previousStates:[]})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyPressed)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyPressed)}},{key:"onKeyPressed",value:function(t){if("TEXTAREA"!==t.target.tagName&&void 0!==this.state.pattern)switch(t.key){case" ":t.preventDefault(),this.saveAndDo(this.next);break;case"c":this.state.repeats.length>0&&this.saveAndDo(this.addRepeat);break;case"v":this.state.repeats.length>0&&this.saveAndDo(this.finishRepeat);break;case"z":t.ctrlKey&&this.undo();break;default:return}}},{key:"handleFormChange",value:function(t){this.setState({patternInput:t.target.value})}},{key:"handleFormSubmit",value:function(t){var e=this;t.preventDefault();var n=k.tokenize(this.state.patternInput),i=k.isInvalid(n);i?alert("Pattern Syntax Error: "+i+"."):this.setState({pattern:n},(function(){n[0][0].type!==f.STR&&e.next()}))}},{key:"next",value:function(){this.setState((function(t){var e={pattern:t.pattern,instrIndex:t.instrIndex,tokIndex:t.tokIndex,repeats:JSON.parse(JSON.stringify(t.repeats)),finished:t.finished};return g(e),Object(o.a)({},e)}))}},{key:"addRepeat",value:function(){this.setState((function(t){var e={pattern:t.pattern,instrIndex:t.instrIndex,tokIndex:t.tokIndex,repeats:JSON.parse(JSON.stringify(t.repeats)),finished:t.finished},n=e.repeats.length-1,i=e.repeats[n].numRepeats;do{g(e)}while(!e.finished&&e.repeats[n]&&i===e.repeats[n].numRepeats);return Object(o.a)({},e)}))}},{key:"finishRepeat",value:function(){var t=this,e=this.state.pattern[this.state.instrIndex],n=this.state.tokIndex;do{n++}while(e[n].type!==f.CLS_PAREN);n++,e[n]?this.setState({tokIndex:n,repeats:JSON.parse(JSON.stringify(this.state.repeats.slice(0,-1)))},(function(){e[n].type!==f.STR&&t.next()})):this.setState({instrIndex:this.state.instrIndex+1,tokIndex:0,repeats:[]},(function(){e[t.state.instrIndex].type!==f.STR&&t.next()}))}},{key:"nextInstruction",value:function(){var t=this,e=this.state.pattern;if(this.state.instrIndex>=e.length-1)this.setState({finished:!0});else{var n=this.state.instrIndex+1;this.setState({instrIndex:n,tokIndex:0,repeats:[]},(function(){e[n][0].type!==f.STR&&t.next()}))}}},{key:"handleRepeatChange",value:function(t,e){var n=e.target.value;if(!n.match(/\D/)){n=parseInt(n);var i=JSON.parse(JSON.stringify(this.state.repeats));i[t].numRepeats=n||0,this.setState({repeats:i})}}},{key:"saveAndDo",value:function(t){this.saveState(),t(),this.storeState()}},{key:"saveState",value:function(){this.setState((function(t){var e=JSON.parse(JSON.stringify(t.previousStates));return e.push({instrIndex:t.instrIndex,tokIndex:t.tokIndex,finished:t.finished,repeats:JSON.parse(JSON.stringify(t.repeats))}),{previousStates:e}}))}},{key:"storeState",value:function(){localStorage.setItem("patternCounterState",JSON.stringify(this.state))}},{key:"undo",value:function(){var t=this,e=JSON.parse(JSON.stringify(this.state.previousStates));this.setState(Object(o.a)(Object(o.a)({},e.pop()),{},{previousStates:e}),(function(){return t.storeState()}))}},{key:"render",value:function(){var t=this;return void 0===this.state.pattern?Object(p.jsx)("div",{children:Object(p.jsx)(b,{value:this.state.patternInput,onChange:this.handleFormChange,onSubmit:this.handleFormSubmit})}):this.state.finished?Object(p.jsxs)("div",{children:[Object(p.jsx)(S,{finished:!0}),Object(p.jsxs)("div",{className:"button-menu",children:[Object(p.jsx)("button",{onClick:this.undo,children:"Undo (ctrl-z)"}),Object(p.jsx)("button",{onClick:function(){return t.initialize(t.state.patternInput)},children:"Submit Anonther Pattern"})]})]}):Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{children:Object(p.jsx)(S,{instruction:this.state.pattern[this.state.instrIndex],tokIndex:this.state.tokIndex,repeats:this.state.repeats,onRepeatChange:function(e,n){return t.saveAndDo((function(){return t.handleRepeatChange(e,n)}))},finished:this.state.finished})}),Object(p.jsxs)("div",{className:"button-menu",children:[Object(p.jsx)("button",{onClick:function(){return t.saveAndDo(t.next)},children:"Next (Space)"}),this.state.repeats.length>0?Object(p.jsx)("button",{onClick:function(){return t.saveAndDo(t.addRepeat)},children:"Complete Repeat (c)"}):null,this.state.repeats.length>0?Object(p.jsx)("button",{onClick:function(){return t.saveAndDo(t.finishRepeat)},children:"Exit repeat (v)"}):null]}),Object(p.jsxs)("div",{className:"button-menu",children:[Object(p.jsx)("button",{onClick:this.undo,children:"Undo (ctrl-z)"}),Object(p.jsx)("button",{onClick:function(){return t.saveAndDo(t.nextInstruction)},children:"Next Instruction"}),Object(p.jsx)("button",{onClick:function(){return t.initialize(t.state.patternInput)},children:"Submit Anonther Pattern"})]})]})}}]),n}(i.Component),C=n.p+"static/media/saucyboy.1dc1fe53.svg";n(20);var P=function(t){return Object(p.jsxs)("aside",{className:"sidebar",children:[Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("div",{id:"title",children:t.title}),Object(p.jsx)("div",{children:t.description}),Object(p.jsx)("div",{children:t.info})]}),Object(p.jsxs)("a",{href:"https://goldinvo.com",className:"link",children:[Object(p.jsx)("img",{src:C,alt:""}),"goldinvo.com"]})]})};r.a.render(Object(p.jsxs)(s.a.StrictMode,{children:[Object(p.jsx)(P,{title:"Pattern Counter",description:"Keep track of your place in your knitting or crochet pattern!",info:Object(p.jsxs)("div",{children:[Object(p.jsxs)("p",{children:["Start by putting inputting your pattern using the pattern counter syntax. Visit my ",Object(p.jsx)("a",{href:"https://goldinvo.com/2021/07/22/pattern-counter.html",target:"_blank",rel:"noreferrer",children:"blog post"})," for examples and usage details."]}),Object(p.jsx)("p",{children:"Please send any questions, comments/feedback, or bug reports my way! I would much appreciate it: goldin@goldinvo.com"})]})}),Object(p.jsx)("div",{className:"content",children:Object(p.jsx)(R,{})})]}),document.getElementById("root"))}],[[21,1,2]]]);
//# sourceMappingURL=main.1ef442af.chunk.js.map