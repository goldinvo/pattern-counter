(this["webpackJsonppattern-counter"]=this["webpackJsonppattern-counter"]||[]).push([[0],[,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var i=n(2),s=n.n(i),a=n(9),r=n.n(a),o=(n(14),n(3)),c=n(4),u=n(5),d=n(1),h=n(7),l=n(6),p=(n(15),n(0));var f=function(e){return Object(p.jsxs)("form",{onSubmit:e.onSubmit,className:"PatternForm",children:[Object(p.jsx)("label",{children:"Input Pattern Below: "}),Object(p.jsx)("textarea",{value:e.value,onChange:e.onChange}),Object(p.jsx)("input",{type:"submit",value:"Submit"})]})},b=Object.freeze({INSTR_CNT:"instrcnt",INFO:"info",NUM:"num",STR:"str",OPN_PAREN:"opnparen",CLS_PAREN:"clsparen",REP:"rep",SEP:"sep"});function v(e){return e.match(/^\d+\.$/)?b.INSTR_CNT:e.match(/(\(.*?\))/)?b.INFO:"("===e||"{"===e||"["===e?b.OPN_PAREN:")"===e||"}"===e||"]"===e?b.CLS_PAREN:"*"===e?b.REP:","===e||"."===e?b.SEP:e.match(/^\d+$/)?b.NUM:b.STR}var j=function(e,t){return{type:e,value:t}};var x=function(e){var t=[],n=0;e.instruction.forEach((function(i,s){i.type===b.OPN_PAREN?s<e.tokIndex?t.push(s):n++:i.type===b.CLS_PAREN&&(s<e.tokIndex?t.pop():n?n--:t.push(s))}));var i=0,s=[],a=e.instruction.map((function(n,a){var r=a===e.tokIndex?"focusedText ":"";return t.includes(a)&&(n.type===b.OPN_PAREN?(r+=e.colors[i],s.push(e.colors[i]),i+1<e.colors.length&&i++):r+=s.pop()),Object(p.jsx)("span",{className:r,children:n.value+" "},a)}));return Object(p.jsx)("div",{className:"instructionText",children:a})};n(17);var O=function(e){return Object(p.jsxs)("div",{className:"counter "+e.color,children:[Object(p.jsxs)("form",{children:[Object(p.jsx)("label",{htmlFor:"counterInput",children:e.name}),Object(p.jsx)("input",{type:"text",maxLength:"3",autoComplete:"off",id:"counterInput",value:e.value,onChange:e.onChange})]}),e.controls?e.controls:null]})},m=function(e){Object(h.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={count:"0"},e.handleChange=e.handleChange.bind(Object(d.a)(e)),e.increment=e.increment.bind(Object(d.a)(e)),e.reset=e.reset.bind(Object(d.a)(e)),e.onKeyPressed=e.onKeyPressed.bind(Object(d.a)(e)),e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyPressed)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyPressed)}},{key:"onKeyPressed",value:function(e){if("TEXTAREA"!==e.target.tagName)switch(e.key){case"z":e.ctrlKey||this.increment(1);break;case"x":this.increment(10);break;default:return}}},{key:"handleChange",value:function(e){var t=e.target.value;t.match(/\D/)||(t=parseInt(t),this.setState({count:t||""}))}},{key:"increment",value:function(e){var t=Number(this.state.count)+e;this.setState({count:t<=999?""+t:""+(t-999-1)})}},{key:"reset",value:function(){this.setState({count:"0"})}},{key:"render",value:function(){var e=this,t=Object(p.jsxs)("div",{id:"controls",style:{display:"flex",justifyContent:"center"},children:[Object(p.jsx)("button",{type:"button",onClick:function(){return e.increment(1)},children:"+1 (z)"}),Object(p.jsx)("button",{type:"button",onClick:function(){return e.increment(10)},children:"+10 (x)"}),Object(p.jsx)("button",{type:"button",onClick:this.reset,children:"Reset"})]});return Object(p.jsx)("div",{className:"manual-counter",children:Object(p.jsx)(O,{name:"Manual Counter",onChange:this.handleChange,value:this.state.count,controls:t})})}}]),n}(i.Component),y=(n(18),["red","orange","yellow"]);b.STR;var N=function(e){var t=e.repeats.map((function(t,n){var i=n<y.length?y[n]:y[y.length-1];return Object(p.jsx)(O,{color:i,name:"Repeat Counter ".concat(n+1),value:t.numRepeats,onChange:function(t){e.onRepeatChange(n,t)}},n)}));return Object(p.jsxs)("div",{className:"instructionView",children:[Object(p.jsx)(x,{instruction:e.instruction,tokIndex:e.tokIndex,colors:y}),Object(p.jsxs)("div",{className:"countersContainer",children:[t,Object(p.jsx)(m,{})]})]})},k=function(){var e=Object.freeze({NO_INPUT:"Please input a pattern",PAREN_MATCH:"One of the instructions has a mismatched count of open and closed parenthesis"});return{tokenize:function(e){var t=e.trim().split("\n").filter((function(e){return""!==e.trim()})).map((function(e){return e.trim().split(/([(){}[\].,*])/).map((function(e){return e.trim()})).filter((function(e){return""!==e}))}));return t=t.map((function(e){return function(e){var t=[],n=0;v(e[0]+e[1])===b.INSTR_CNT&&(t.push(j(b.INSTR_CNT,e[0]+e[1])),n+=2);for(;n<e.length;){var i=v(e[n]);if(i===b.OPN_PAREN){var s=e[n]+e[n+1],a=e[n]+e[n+1]+e[n+2];if(v(s)===b.INFO){t.push(j(b.INFO,s)),n+=2;continue}if(v(a)===b.INFO){t.push(j(b.INFO,a)),n+=3;continue}}t.push(j(i,e[n])),n++}return t}(e)}))},isInvalid:function(t){if(!t[0]||!t[0][0])return e.NO_INPUT;var n=!0;return t.forEach((function(e){0!==e.reduce((function(e,t){return t.type===b.OPN_PAREN?e++:t.type===b.CLS_PAREN&&e--,e}),0)&&(n=!1)})),!n&&e.PAREN_MATCH},PTN_ERR:e}}();n(19);function I(e){var t,n,i,s=e.pattern,a=e.instrIndex,r=e.tokIndex,o=e.finished,c=e.repeats.slice();s[a][r].type===b.OPN_PAREN?(c.push({index:r,numRepeats:0}),r++):s[a][r].type===b.CLS_PAREN?(t=s[a],n=r,i=c[c.length-1].numRepeats,t[n].type!==b.CLS_PAREN&&console.log("fxn needToRepeat!!!!!"),t[n+1]&&t[n+1].type!==b.REP||!t[n+2]||t[n+2].type!==b.NUM||i<Number(t[n+2].value)-1?(r=c[c.length-1].index+1,c[c.length-1].numRepeats++):(c.pop(),r++)):r++,s[a][r]||(a>=s.length-1?(r=e.tokIndex,c=e.repeats.slice(),o=!0):(a++,r=0)),e.pattern=s,e.instrIndex=a,e.tokIndex=r,e.repeats=c,e.finished=o}function S(e){var t=e.instrIndex,n=e.tokIndex,i=JSON.parse(JSON.stringify(e.repeats));do{I(e)}while(e.pattern[e.instrIndex][e.tokIndex].type!==b.STR&&!e.finished);e.finished&&(e.instrIndex=t,e.tokIndex=n,e.repeats=i)}var g=function(e){Object(h.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={patternInput:"Press the 'Next' button or spacebar to advance!\n\n4. sc 3, hdc, dc 3, hdc, sc 3\n5. (sc 3, dc 5) * 3 (24 sts) (parenthesis without commas or periods are ignored)\n\nOn the next instruction try using the 'Complete Repeat' button! \n\n6. ((sc 2, dec) * 5, sc) * 3\n\nYou can also type into the counter display to edit counts directly!\n\n7. ((sc, dc, sc) * 594, sc 3, dc 2) * 2 (Click on the orange counter number and type in something else)\n\nSwitch to a G hook (Instructions don't have to start with a number)\n\nYou will need to use the 'Exit repeat' button in the next instruction\n\n8. (sc 3, picot) until end of row, sc, hdc, dc\n\nCut and weave in ends (Now try your own pattern!)\n",pattern:void 0,instrIndex:0,tokIndex:0,finished:!1,repeats:[],previousStates:[]},e.initialize=e.initialize.bind(Object(d.a)(e)),e.handleFormChange=e.handleFormChange.bind(Object(d.a)(e)),e.handleFormSubmit=e.handleFormSubmit.bind(Object(d.a)(e)),e.next=e.next.bind(Object(d.a)(e)),e.nextInstruction=e.nextInstruction.bind(Object(d.a)(e)),e.finishRepeat=e.finishRepeat.bind(Object(d.a)(e)),e.addRepeat=e.addRepeat.bind(Object(d.a)(e)),e.handleRepeatChange=e.handleRepeatChange.bind(Object(d.a)(e)),e.onKeyPressed=e.onKeyPressed.bind(Object(d.a)(e)),e.undo=e.undo.bind(Object(d.a)(e)),e.saveAndDo=e.saveAndDo.bind(Object(d.a)(e)),e}return Object(u.a)(n,[{key:"initialize",value:function(e){this.setState({patternInput:e,pattern:void 0,instrIndex:0,tokIndex:0,finished:!1,repeats:[],previousStates:[]})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyPressed)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyPressed)}},{key:"onKeyPressed",value:function(e){if("TEXTAREA"!==e.target.tagName&&void 0!==this.state.pattern)switch(e.key){case" ":e.preventDefault(),this.saveAndDo(this.next);break;case"c":this.state.repeats.length>0&&this.saveAndDo(this.addRepeat);break;case"v":this.state.repeats.length>0&&this.saveAndDo(this.finishRepeat);break;case"z":e.ctrlKey&&this.undo();break;default:return}}},{key:"handleFormChange",value:function(e){this.setState({patternInput:e.target.value})}},{key:"handleFormSubmit",value:function(e){var t=this;e.preventDefault();var n=k.tokenize(this.state.patternInput),i=k.isInvalid(n);i?alert("Pattern Syntax Error: "+i+"."):this.setState({pattern:n},(function(){n[0][0].type!==b.STR&&t.next()}))}},{key:"next",value:function(){this.setState((function(e){var t={pattern:e.pattern,instrIndex:e.instrIndex,tokIndex:e.tokIndex,repeats:JSON.parse(JSON.stringify(e.repeats)),finished:e.finished};return S(t),Object(o.a)({},t)}))}},{key:"addRepeat",value:function(){this.setState((function(e){var t={pattern:e.pattern,instrIndex:e.instrIndex,tokIndex:e.tokIndex,repeats:JSON.parse(JSON.stringify(e.repeats)),finished:e.finished},n=t.repeats.length-1,i=t.repeats[n].numRepeats;do{S(t)}while(!t.finished&&t.repeats[n]&&i===t.repeats[n].numRepeats);return Object(o.a)({},t)}))}},{key:"finishRepeat",value:function(){var e=this,t=this.state.pattern[this.state.instrIndex],n=this.state.tokIndex;do{n++}while(t[n].type!==b.CLS_PAREN);this.setState({tokIndex:n+1,repeats:JSON.parse(JSON.stringify(this.state.repeats.slice(0,-1)))},(function(){t[n+1].type!==b.STR&&e.next()}))}},{key:"nextInstruction",value:function(){var e=this,t=this.state.pattern;if(this.state.instrIndex>=t.length-1)this.setState({finished:!0});else{var n=this.state.instrIndex+1;this.setState({instrIndex:n,tokIndex:0,repeats:[]},(function(){t[n][0].type!==b.STR&&e.next()}))}}},{key:"handleRepeatChange",value:function(e,t){var n=t.target.value;if(!n.match(/\D/)){n=parseInt(n);var i=JSON.parse(JSON.stringify(this.state.repeats));i[e].numRepeats=n||0,this.setState({repeats:i})}}},{key:"saveAndDo",value:function(e){this.saveState(),e()}},{key:"saveState",value:function(){this.setState((function(e){var t=JSON.parse(JSON.stringify(e.previousStates));return t.push({instrIndex:e.instrIndex,tokIndex:e.tokIndex,finished:e.finished,repeats:JSON.parse(JSON.stringify(e.repeats))}),{previousStates:t}}))}},{key:"undo",value:function(){var e=JSON.parse(JSON.stringify(this.state.previousStates));this.setState(Object(o.a)(Object(o.a)({},e.pop()),{},{previousStates:e}))}},{key:"render",value:function(){var e=this;return void 0!==this.state.pattern?Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{children:Object(p.jsx)(N,{instruction:this.state.pattern[this.state.instrIndex],tokIndex:this.state.tokIndex,repeats:this.state.repeats,onRepeatChange:function(t,n){return e.saveAndDo((function(){return e.handleRepeatChange(t,n)}))},finished:this.state.finished})}),Object(p.jsxs)("div",{className:"button-menu",children:[Object(p.jsx)("button",{onClick:function(){return e.saveAndDo(e.next)},children:"Next (Space)"}),this.state.repeats.length>0?Object(p.jsx)("button",{onClick:function(){return e.saveAndDo(e.addRepeat)},children:"Complete Repeat (c)"}):null,this.state.repeats.length>0?Object(p.jsx)("button",{onClick:function(){return e.saveAndDo(e.finishRepeat)},children:"Exit repeat (v)"}):null]}),Object(p.jsxs)("div",{className:"button-menu",children:[Object(p.jsx)("button",{onClick:this.undo,children:"Undo (ctrl-z)"}),Object(p.jsx)("button",{onClick:function(){return e.saveAndDo(e.nextInstruction)},children:"Next Instruction"}),Object(p.jsx)("button",{onClick:function(){return e.initialize(e.state.patternInput)},children:"Submit Anonther Pattern"})]})]}):Object(p.jsx)("div",{children:Object(p.jsx)(f,{value:this.state.patternInput,onChange:this.handleFormChange,onSubmit:this.handleFormSubmit})})}}]),n}(i.Component),R=n.p+"static/media/saucyboy.1dc1fe53.svg";n(20);var C=function(e){return Object(p.jsxs)("aside",{className:"sidebar",children:[Object(p.jsxs)("div",{className:"header",children:[Object(p.jsx)("div",{id:"title",children:e.title}),Object(p.jsx)("div",{children:e.description}),Object(p.jsx)("div",{children:e.info})]}),Object(p.jsxs)("a",{href:"https://goldinvo.com",class:"link",children:[Object(p.jsx)("img",{src:R,alt:""}),"goldinvo.com"]})]})};r.a.render(Object(p.jsxs)(s.a.StrictMode,{children:[Object(p.jsx)(C,{title:"Pattern Counter",description:"Keep track of your place in your knitting or crochet pattern!",info:Object(p.jsx)("div",{children:Object(p.jsxs)("p",{children:["Start by putting inputting your pattern in the correct syntax. See the given examples, or visit my ",Object(p.jsx)("a",{href:"https://goldinvo.com",children:"blog post"})," for details."]})})}),Object(p.jsx)("div",{class:"content",children:Object(p.jsx)(g,{})})]}),document.getElementById("root"))}],[[21,1,2]]]);
//# sourceMappingURL=main.fa8515a2.chunk.js.map